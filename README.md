# DTLS Proxy and Client

## Installation

Dependencies:
```
pip install python3-dtls    (v1.3.0)
pip install pyOpenSSL       (v22.0.0 and v24.1.0)
pip install Flask           (v3.0.3)
```

1. Run the script `install/generateCerts.sh` to generate the necessary certificates and store in `install/cert/` directory for backup. The script will copy the necessary files for the respective directories in Proxy and Stub Applications.

2. Copy the following files from `install/cert/` to FREE Project `FREE_WEB/free/videoConfig/Certificates` (create folder if needed), so that FREE can generate the certificates and communicate to Proxy the expected public key:
```
ca.key
ca.pem
```
3. Start Proxy Application.

4. In FREE Front-End, create a new VideoConfig.
Verify Proxy configuration file (`src/proxy/listeners_proxy.cfg`) for the configuration generated by FREE consuming Proxy REST Endpoints.

5. Replace the `proxy_server_port` value in file `src/stub/video-stream.ini` to the value of FREE VideoConfig Front-End.

6. Replace the content of `src/stub/certs/stub.key` and `src/stub/certs/stub.pem` with the content from the VideoConfig Front-End.
Start Stub Application (and `video-stream.sh`).
Proxy Application should log this (ex: ApparatusID 30):
```
INFO - Client public key matches the expected public key. Successfully connected!
INFO - Apparatus ID 30 is now available.
```

7. Open video on Front-End.


--------------------------
Proxy Application has REST Endpoints on port 5000. The value can be changed in the last line of 'proxy.py' (need to change on FREE VideoConfig backend too)
